---
layout : single
title : "Strassen Algorithm"
date : 2020-04-12
categories : jekyll update
use_math : true
---

# 슈트라센 알고리즘



## 정의

- 독일의 수학자 폴커 슈트라센(Volker Strassen)이 1969년 개발한 **행렬 곱셈 알고리즘**이다.
- 두 행렬을 곱하면 $$ O(n^3) $$ 의 시간 복잡도가 소요되지만 이 알고리즘을 사용하면 대략 $$ O(n^{2.807}) $$ 의 시간 복잡도가 소요된다.



## 기존의 행렬곱은?

크기가 $$n*n$$인 두 행렬 A와 B의 곱을 C로 나타낼때 A의 원소를 $$ a_{ij} $$ 라 하고, $$ i $$ 는 가로, $$ j $$ 는 세로를 나타낸다.

B와 C도 동일하게 표시할 때, 

행렬의 곱셈은

---

$$ C_{ij} = \sum_{k=1}^n a_{ik}b_{kj} $$

$$ = a_{i1}b_{1j} + a_{i2}b_{1j} + ... + a_{in}b_{nj} $$

---

C행렬의 하나의 원소를 구하는데 드는 시간은 곱셈 $$n$$번 과 덧셈 $$n-1$$번이다. 

따라서 C 전체를 구할 경우 C의 크기는 $$n*n$$ 이므로 곱셈을 $$n^3$$번 

(예. $$n=2$$일 때는 하나의 원소를 구하는 곱셈 2회를 $$n*n=n^2$$. 

 즉 4회 반복하므로 8회이다.)

 덧셈은 $$n^2(n-1)$$번 하게 된다.

따라서 두 행렬을 구하는 시간 복잡도는 $$ f(n) = 2n^3-n^2 $$에서 구하면 $$O(n^3)$$이다.



## 슈트라센 알고리즘을 사용하면?

행렬 A와 B를 $$2n*2n$$꼴로 만들어준다. 

그 이유는 A와 B를 각각 4개의 부분행렬로 나누기 위함이다. 

만약 $$2n*2n$$꼴이 아닌 경우 가로, 세로줄에 0으로 이루어진 줄을 채워서 형태를 만들어준다.

슈트라센 알고리즘의 핵심은 행렬의 곱셈을 더하기 연산으로 풀어 각 원소를 구할 수 있는 M이라는 연산 행렬을 새로 만든다는 것이다.

슈트라센 알고리즘에 의한 행렬 M은

---

$$ M_1 = (A_{11}+A_{22})(B_{11}+B_{22}) $$

$$ M_2 = (A_{21}+A_{22})B_{11} $$

$$ M_3 = A_{11}(B_{12}-B_{22}) $$

$$ M_4 = A_{22}(B_{21}-B_{11}) $$

$$ M_5 = (A_{11} + A_{12})B_{22} $$

$$ M_6 = (A_{21}-A_{11})(B_{11}+B_{12}) $$

$$ M_7 = (A_{12}-A_{22})(B_{21}+B_{22}) $$

​	=> 곱셈 7회, 덧셈 10회 사용

---



최종적으로 구하려는 행렬 C는 행렬 M의 더하기 연산으로 이루어져 있다.

---

$$ C_{11} = M_1+M_4-M_5+M_7 $$

$$ C_{12} = M_3+M_5 $$

$$ C_{21} = M_2+M_4 $$

$$ C_{22} = M_1-M_2+M_3+M_6 $$

​	=> 덧셈 8회 사용

---



기존 행렬곱은 곱셈 8회에 덧셈 4회를 사용하는 대신, 슈트라센 알고리즘은 곱셈 7회, 덧셈 18회를 사용한다. 

언뜻 봐선 기존 알고리즘보다 복잡해보이지만 컴퓨터에서 행렬 곱셈이 덧셈보다 더 많은 시간이 소요되기 때문에 원소가 많은 행렬일수록 슈트라센 알고리즘을 사용하는 것이 더 효율적이다.

시간 복잡도는 어떻게 나오는 것일까?

A, B 행렬을 부분행렬로 나누었으므로 $$ n/2 * n/2 $$ 크기의 행렬을 7번 곱하고 18번 더한 것과 같다. 더하기는 점근 표기법에 의해 생략 가능하므로  곱하기만 계산해보면 (점화식으로 표현)

---

$$ t(n) = 7*t(n/2) $$ $$  = 7*7*t(n/4) $$ ...

 $$ =7^{logn} = n^{2.807...} $$

---

즉, $$ O(n^{2.807...}) $$의 시간 복잡도를 갖는다.

